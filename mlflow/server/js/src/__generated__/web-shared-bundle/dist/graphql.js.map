{"version":3,"file":"graphql.js","sources":["../src/graphql/links/BackgroundLink.ts","../src/graphql/links/OfflineLink.ts"],"sourcesContent":["import QueueLink from 'apollo-link-queue';\n\n// This link ensures that queries from background tabs are held in a queue.\n// We need this to make sure that these background tabs don't cause load on the server.\n// The link has to be constructed dynamically so we can pass in a custom timeout, which\n// may only be available once the settings have been initialized.\nexport const makeBackgroundLink = (timeoutMs: number) => {\n  const link = new QueueLink();\n\n  let offlineTimeout: number;\n\n  const handleVisibilityChange = () => {\n    if (document.hidden) {\n      // Using window.setTimeout to avoid type issues with node vs. browser\n      offlineTimeout = window.setTimeout(() => {\n        if (document.hidden) {\n          link.close();\n        }\n      }, timeoutMs);\n    } else {\n      clearTimeout(offlineTimeout);\n      link.open();\n    }\n  };\n\n  // We call handleVisibilityChange once on load in case the tab is hidden when it loads.\n  handleVisibilityChange();\n\n  document.addEventListener('visibilitychange', handleVisibilityChange, false);\n\n  return link;\n};\n","import QueueLink from 'apollo-link-queue';\n\nexport const offlineLink = new QueueLink();\n\nwindow.addEventListener('offline', () => offlineLink.close());\nwindow.addEventListener('online', () => offlineLink.open());\n"],"names":["makeBackgroundLink","timeoutMs","link","QueueLink","offlineTimeout","handleVisibilityChange","document","hidden","window","setTimeout","close","clearTimeout","open","addEventListener","offlineLink"],"mappings":";;AAGA;AACA;AACA;;MACaA,kBAAkB,GAAIC,SAAD,IAAuB;EACvD,MAAMC,IAAI,GAAG,IAAIC,SAAJ,EAAb;EAEA,IAAIC,cAAJ;;EAEA,MAAMC,sBAAsB,GAAG,MAAM;IACnC,IAAIC,QAAQ,CAACC,MAAb,EAAqB;;MAEnBH,cAAc,GAAGI,MAAM,CAACC,UAAP,CAAkB,MAAM;QACvC,IAAIH,QAAQ,CAACC,MAAb,EAAqB;UACnBL,IAAI,CAACQ,KAAL;;OAFa,EAIdT,SAJc,CAAjB;KAFF,MAOO;MACLU,YAAY,CAACP,cAAD,CAAZ;MACAF,IAAI,CAACU,IAAL;;GAVJ,CALuD;;;EAoBvDP,sBAAsB;EAEtBC,QAAQ,CAACO,gBAAT,CAA0B,kBAA1B,EAA8CR,sBAA9C,EAAsE,KAAtE;EAEA,OAAOH,IAAP;AACD;;MC7BYY,WAAW,GAAG,IAAIX,SAAJ;AAE3BK,MAAM,CAACK,gBAAP,CAAwB,SAAxB,EAAmC,MAAMC,WAAW,CAACJ,KAAZ,EAAzC;AACAF,MAAM,CAACK,gBAAP,CAAwB,QAAxB,EAAkC,MAAMC,WAAW,CAACF,IAAZ,EAAxC;;;;"}